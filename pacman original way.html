<!DOCTYPE html>
<html>
<head>
    <title></title>
    <link rel="stylesheet" type="text/css" href="pacman.css">
</head>
<body>
<div class="ijkl"></div>
</body>

<script type="text/javascript">

    class Queue {
        constructor() {
            this.items = [];
        }
        isEmpty() {
            return this.items.length === 0;
        }
        enqueue(elements) {
            this.items.push(elements);
        }
        dequeue() {
            if (this.isEmpty())
                return "Underflow";
            return this.items.shift();
        }
        front() {
            if (this.isEmpty())
                return "No elements in Queue";
            return this.items[0];
        }
        printQueue() {
            var str = "";
            for(var i = 0; i < this.items.length; i++)
                str += "(" + this.items[0].pt.x.toString() + ", " + this.items[0].pt.y.toString() + "), " + this.items[0].dist + "; ";
            return str;
        }
    }

    class Ghost {
        constructor() {
            this.name = "";
            this.direction = {};
            this.position = {};
            this.classActive = "";
            this.speed = 400;
        }
        move(matrix, matrixCopy, pacmanPos, targetPos, ghost1, ghost2, ghost3) {
            if (isGameOver(pacmanPos, this, ghost1, ghost2, ghost3) === true) {
                clearInterval(window.pacmanInterval);
                clearInterval(window.blinkyInterval);
                clearInterval(window.inkyInterval);
                clearInterval(window.pinkyInterval);
                clearInterval(window.clydeInterval);
                b.innerHTML = "<h1>Game Over</h1>";
            }
            var i, adjPosArray = [], adjPos = {}, rowNum = [-1, 0, 0, 1], colNum = [0, -1, 1, 0];
            for (i = 0; i < 4; i++) {
                if (this.direction.x === -1 * rowNum[i] && this.direction.y === -1 * colNum[i])
                    continue;
                var row = this.position.x + rowNum[i];
                var col = this.position.y + colNum[i];
                if (row === tunnelEnd.x && col === tunnelEnd.y && i === 2) {
                    row = tunnelStart.x;
                    col = tunnelStart.y;
                    adjPos = {pt: {x: row, y: col}, dist: Math.sqrt(Math.pow(targetPos.x - row, 2) + Math.pow(targetPos.y - col, 2))};
                    adjPosArray.push(adjPos);
                }
                else if (row === tunnelStart.x && col === tunnelStart.y && i === 1) {
                    row = tunnelEnd.x;
                    col = tunnelEnd.y;
                    adjPos = {pt: {x: row, y: col}, dist: Math.sqrt(Math.pow(targetPos.x - row, 2) + Math.pow(targetPos.y - col, 2))};
                    adjPosArray.push(adjPos);
                }
                if (isValid(row, col) === true && (isValidClass(matrix[row][col]) || matrix[row][col] === 'H8'))  {
                    adjPos = {pt: {x: row, y: col}, dist: Math.sqrt(Math.pow(targetPos.x - row, 2) + Math.pow(targetPos.y - col, 2)) };
                    adjPosArray.push(adjPos);
                }
            }
            var newPos = {};
            if (adjPosArray.length === 3)
                newPos = adjPosArray[0].dist < adjPosArray[1].dist ? (adjPosArray[0].dist < adjPosArray[2].dist ? adjPosArray[0].pt : adjPosArray[2].pt) : (adjPosArray[1].dist < adjPosArray[2].dist ? adjPosArray[1].pt : adjPosArray[2].pt);
            else if (adjPosArray.length === 2)
                newPos = adjPosArray[0].dist < adjPosArray[1].dist ? adjPosArray[0].pt : adjPosArray[1].pt;
            else if (adjPosArray.length === 1 )
                newPos = adjPosArray[0].pt;
            this.setDirection(newPos.x - this.position.x, newPos.y - this.position.y);
            var otherGhostDirection = {}, updatedOtherGhostDirection = {}, otherGhostPos = {}, updatedOtherGhostPos = {};
            var ghostArray = [ghost1, ghost2, ghost3];
            var ghostCollision = false;
            for(i = 0; i < 3; i++)
            {
                var currGhost = ghostArray[i];
                if (newPos.x === currGhost.getPos().x && newPos.y === currGhost.getPos().y) {
                    ghostCollision = true;
                    if (isValidClass(matrix[this.position.x + this.direction.x * -1][this.position.y + this.direction.y * -1]) === true) {
                        matrixCopy[this.position.x][this.position.y] = matrix[this.position.x][this.position.y];
                        drawLevelParts(matrixCopy[this.position.x][this.position.y], {x: this.position.x, y: this.position.y});
                        this.setDirection(this.direction.x * -1, this.direction.y * -1);
                        this.setPos(this.position.x + this.direction.x, this.position.y + this.direction.y);
                        matrixCopy[this.position.x][this.position.y] = this.classActive;
                        drawLevelParts(matrixCopy[this.position.x][this.position.y], {x: this.position.x, y: this.position.y});
                    }

                    otherGhostDirection = {x: currGhost.getDirection().x, y: currGhost.getDirection().y};
                    otherGhostPos = {x: currGhost.getPos().x, y: currGhost.getPos().y};
                    updatedOtherGhostDirection = {x: otherGhostDirection.x * -1, y: otherGhostDirection.y * -1};
                    updatedOtherGhostPos = {x: otherGhostPos.x + updatedOtherGhostDirection.x, y: otherGhostPos.y + updatedOtherGhostDirection.y};
                    if (isValidClass(matrix[updatedOtherGhostPos.x][updatedOtherGhostPos.y]) === true) {
                        currGhost.setDirection(updatedOtherGhostDirection.x, updatedOtherGhostDirection.y);
                        currGhost.setPos(updatedOtherGhostPos.x, updatedOtherGhostPos.y);
                        matrixCopy[otherGhostPos.x][otherGhostPos.y] = matrix[otherGhostPos.x][otherGhostPos.y];
                        matrixCopy[updatedOtherGhostPos.x][updatedOtherGhostPos.y] = currGhost.getClass();
                        drawLevelParts(matrixCopy[otherGhostPos.x][otherGhostPos.y], {x: otherGhostPos.x, y: otherGhostPos.y});
                        drawLevelParts(matrixCopy[updatedOtherGhostPos.x][updatedOtherGhostPos.y], {x: updatedOtherGhostPos.x, y: updatedOtherGhostPos.y});
                    }
                }
            }
            if (ghostCollision === false) {
                matrixCopy[this.position.x][this.position.y] = matrix[this.position.x][this.position.y];
                matrixCopy[newPos.x][newPos.y] = this.classActive;
                drawLevelParts(matrixCopy[this.position.x][this.position.y], {x: this.position.x, y: this.position.y});
                drawLevelParts(matrixCopy[newPos.x][newPos.y], {x: newPos.x, y: newPos.y});
                this.position = newPos;
                console.log(this.position, this.direction);
            }
        }
        setDirection(x, y) {
            this.direction.x = x;
            this.direction.y = y;
            if (x === -1 && y === 0)
                this.classActive = this.name + "Up1";
            else if (x === 1 && y === 0)
                this.classActive = this.name + "Down1";
            else if (x === 0 && y === -1)
                this.classActive = this.name + "Left1";
            else if (x === 0 && y === 1)
                this.classActive = this.name + "Right1";
        }
        setPos(x, y) {
            this.position.x = x;
            this.position.y = y;
        }
        setSpeed(speed) {
            this.speed = speed;
        }
        setName(name) {
            this.name = name;
        }
        setClass(classActive) {
            this.classActive = classActive;
        }
        getDirection() {
            return this.direction;
        }
        getPos() {
            return this.position;
        }
        getClass() {
            return this.classActive;
        }
        getSpeed() {
            return this.speed;
        }
    }

    str = "";
    b = document.getElementsByTagName("body")[0];
    ROW_MAX = 31;
    COL_MAX = 28;
    pacmanSpeed = 160;
    pacmanDirection = {x: -1, y: 0};
    tunnelStart = {x:14 ,y: 0};
    tunnelEnd = {x:14 ,y: 27};
    pacmanMouthAngle = 360;
    angleDiff = 45;
    pacmanInterval = null;

    blinky = new Ghost();
    blinky.setName("blinky");
    blinky.setPos(15, 12);//15, 14
    blinky.setDirection(-1, 0);
    blinky.setSpeed(300);
    blinkyLeftHouse = false;
    blinkyInterval = null;

    inky = new Ghost();
    inky.setName("inky");
    inky.setPos(15, 13);
    inky.setDirection(-1, 0);
    inky.setSpeed(300);
    inkyLeftHouse = false;
    inkyInterval = null;

    pinky = new Ghost();
    pinky.setName("pinky");
    pinky.setPos(15, 14);
    pinky.setDirection(-1, 0);
    pinky.setSpeed(300);
    pinkyLeftHouse = false;
    pinkyInterval = null;

    clyde = new Ghost();
    clyde.setName("clyde");
    clyde.setPos(15, 15);
    clyde.setDirection(-1, 0);
    clyde.setSpeed(300);
    clydeLeftHouse = false;
    clydeInterval = null;

    alternateGhostAnimate = 0.5;

    function levelGenerator(level) {
        if (level === 1) {
            return ([
                ['B1', 'B4', 'B4', 'B4', 'B4', 'B4', 'B4', 'B4', 'B4', 'B4', 'B4', 'B4', 'B4', 'E7', 'E1', 'B4', 'B4', 'B4', 'B4', 'B4', 'B4', 'B4', 'B4', 'B4', 'B4', 'B4', 'B4', 'B7'],
                ['B6', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'b2', 'b6', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'B2'],
                ['B6', 'pp', 'b1', 'b8', 'b8', 'b7', 'pp', 'b1', 'b8', 'b8', 'b8', 'b7', 'pp', 'b2', 'b6', 'pp', 'b1', 'b8', 'b8', 'b8', 'b7', 'pp', 'b1', 'b8', 'b8', 'b7', 'pp', 'B2'],
                ['B6', 'PP', 'b2', 'ze', 'ze', 'b6', 'pp', 'b2', 'ze', 'ze', 'ze', 'b6', 'pp', 'b2', 'b6', 'pp', 'b2', 'ze', 'ze', 'ze', 'b6', 'pp', 'b2', 'ze', 'ze', 'b6', 'PP', 'B2'],
                ['B6', 'pp', 'b3', 'b4', 'b4', 'b5', 'pp', 'b3', 'b4', 'b4', 'b4', 'b5', 'pp', 'b3', 'b5', 'pp', 'b3', 'b4', 'b4', 'b4', 'b5', 'pp', 'b3', 'b4', 'b4', 'b5', 'pp', 'B2'],
                ['B6', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'B2'],
                ['B6', 'pp', 'b1', 'b8', 'b8', 'b7', 'pp', 'b1', 'b7', 'pp', 'b1', 'b8', 'b8', 'b8', 'b8', 'b8', 'b8', 'b7', 'pp', 'b1', 'b7', 'pp', 'b1', 'b8', 'b8', 'b7', 'pp', 'B2'],
                ['B6', 'pp', 'b3', 'b4', 'b4', 'b5', 'pp', 'b2', 'b6', 'pp', 'b3', 'b4', 'b4', 'b7', 'b1', 'b4', 'b4', 'b5', 'pp', 'b2', 'b6', 'pp', 'b3', 'b4', 'b4', 'b5', 'pp', 'B2'],
                ['B6', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'b2', 'b6', 'pp', 'pp', 'pp', 'pp', 'b2', 'b6', 'pp', 'pp', 'pp', 'pp', 'b2', 'b6', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'B2'],
                ['B3', 'B8', 'B8', 'B8', 'B8', 'b7', 'pp', 'b2', 'b3', 'b8', 'b8', 'b7', 'pp', 'b2', 'b6', 'pp', 'b1', 'b8', 'b8', 'b5', 'b6', 'pp', 'b1', 'B8', 'B8', 'B8', 'B8', 'B5'],
                ['ze', 'ze', 'ze', 'ze', 'ze', 'B6', 'pp', 'b2', 'b1', 'b4', 'b4', 'b5', 'pp', 'b3', 'b5', 'pp', 'b3', 'b4', 'b4', 'b7', 'b6', 'pp', 'B2', 'ze', 'ze', 'ze', 'ze', 'ze'],
                ['ze', 'ze', 'ze', 'ze', 'ze', 'B6', 'pp', 'b2', 'b6', 'ze', 'ze', 'ze', 'ze', 'ze', 'ze', 'ze', 'ze', 'ze', 'ze', 'b2', 'b6', 'pp', 'B2', 'ze', 'ze', 'ze', 'ze', 'ze'],
                ['ze', 'ze', 'ze', 'ze', 'ze', 'B6', 'pp', 'b2', 'b6', 'ze', 'H1', 'B8', 'L8', 'H8', 'H8', 'R8', 'B8', 'H7', 'ze', 'b2', 'b6', 'pp', 'B2', 'ze', 'ze', 'ze', 'ze', 'ze'],
                ['B4', 'B4', 'B4', 'B4', 'B4', 'b5', 'pp', 'b3', 'b5', 'ze', 'B2', 'ze', 'ze', 'ze', 'ze', 'ze', 'ze', 'B6', 'ze', 'b3', 'b5', 'pp', 'b3', 'B4', 'B4', 'B4', 'B4', 'B4'],
                ['ze', 'ze', 'ze', 'ze', 'ze', 'ze', 'pp', 'ze', 'ze', 'ze', 'B2', 'ze', 'ze', 'ze', 'ze', 'ze', 'ze', 'B6', 'ze', 'ze', 'ze', 'pp', 'ze', 'ze', 'ze', 'ze', 'ze', 'ze'],
                ['B8', 'B8', 'B8', 'B8', 'B8', 'b7', 'pp', 'b1', 'b7', 'ze', 'B2', 'ze', 'ze', 'ze', 'ze', 'ze', 'ze', 'B6', 'ze', 'b1', 'b7', 'pp', 'b1', 'B8', 'B8', 'B8', 'B8', 'B8'],
                ['ze', 'ze', 'ze', 'ze', 'ze', 'B6', 'pp', 'b2', 'b6', 'ze', 'H3', 'B4', 'B4', 'B4', 'B4', 'B4', 'B4', 'H5', 'ze', 'b2', 'b6', 'pp', 'B2', 'ze', 'ze', 'ze', 'ze', 'ze'],
                ['ze', 'ze', 'ze', 'ze', 'ze', 'B6', 'pp', 'b2', 'b6', 'ze', 'ze', 'ze', 'ze', 'ze', 'ze', 'ze', 'ze', 'ze', 'ze', 'b2', 'b6', 'pp', 'B2', 'ze', 'ze', 'ze', 'ze', 'ze'],
                ['ze', 'ze', 'ze', 'ze', 'ze', 'B6', 'pp', 'b2', 'b6', 'ze', 'b1', 'b8', 'b8', 'b8', 'b8', 'b8', 'b8', 'b7', 'ze', 'b2', 'b6', 'pp', 'B2', 'ze', 'ze', 'ze', 'ze', 'ze'],
                ['B1', 'B4', 'B4', 'B4', 'B4', 'b5', 'pp', 'b3', 'b5', 'ze', 'b3', 'b4', 'b4', 'b7', 'b1', 'b4', 'b4', 'b5', 'ze', 'b3', 'b5', 'pp', 'b3', 'B4', 'B4', 'B4', 'B4', 'B7'],
                ['B6', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'b2', 'b6', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'B2'],
                ['B6', 'pp', 'b1', 'b8', 'b8', 'b7', 'pp', 'b1', 'b8', 'b8', 'b8', 'b7', 'pp', 'b2', 'b6', 'pp', 'b1', 'b8', 'b8', 'b8', 'b7', 'pp', 'b1', 'b8', 'b8', 'b7', 'pp', 'B2'],
                ['B6', 'pp', 'b3', 'b4', 'b7', 'b6', 'pp', 'b3', 'b4', 'b4', 'b4', 'b5', 'pp', 'b3', 'b5', 'pp', 'b3', 'b4', 'b4', 'b4', 'b5', 'pp', 'b2', 'b1', 'b4', 'b5', 'pp', 'B2'],
                ['B6', 'PP', 'pp', 'pp', 'b2', 'b6', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'b2', 'b6', 'pp', 'pp', 'PP', 'B2'],
                ['E3', 'b8', 'b7', 'pp', 'b2', 'b6', 'pp', 'b1', 'b7', 'pp', 'b1', 'b8', 'b8', 'b8', 'b8', 'b8', 'b8', 'b7', 'pp', 'b1', 'b7', 'pp', 'b2', 'b6', 'pp', 'b1', 'b8', 'E5'],
                ['C8', 'b4', 'b5', 'pp', 'b3', 'b5', 'pp', 'b2', 'b6', 'pp', 'b3', 'b4', 'b4', 'b7', 'b1', 'b4', 'b4', 'b5', 'pp', 'b2', 'b6', 'pp', 'b3', 'b5', 'pp', 'b3', 'b4', 'C9'],
                ['B6', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'b2', 'b6', 'pp', 'pp', 'pp', 'pp', 'b2', 'b6', 'pp', 'pp', 'pp', 'pp', 'b2', 'b6', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'B2'],
                ['B6', 'pp', 'b1', 'b8', 'b8', 'b8', 'b8', 'b5', 'b3', 'b8', 'b8', 'b7', 'pp', 'b2', 'b6', 'pp', 'b1', 'b8', 'b8', 'b5', 'b3', 'b8', 'b8', 'b8', 'b8', 'b7', 'pp', 'B2'],
                ['B6', 'pp', 'b3', 'b4', 'b4', 'b4', 'b4', 'b4', 'b4', 'b4', 'b4', 'b5', 'pp', 'b3', 'b5', 'pp', 'b3', 'b4', 'b4', 'b4', 'b4', 'b4', 'b4', 'b4', 'b4', 'b5', 'pp', 'B2'],
                ['B6', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'pp', 'B2'],
                ['B3', 'B8', 'B8', 'B8', 'B8', 'B8', 'B8', 'B8', 'B8', 'B8', 'B8', 'B8', 'B8', 'B8', 'B8', 'B8', 'B8', 'B8', 'B8', 'B8', 'B8', 'B8', 'B8', 'B8', 'B8', 'B8', 'B8', 'B5']
            ]);
        }
    }

    function isValid(row, col) {
        return ((row >= 0) && (row < ROW_MAX) && (col >= 0) && (col < COL_MAX));
    }

    function isValidClass(classAtPos) {
        return (classAtPos === "pp" || classAtPos === "PP" || classAtPos === "ze");
    }

    function isGameOver(pacmanPos, blinky, pinky, inky, clyde) {
        return ((blinky.getPos().x === pacmanPos.x && blinky.getPos().y === pacmanPos.y) || (pinky.getPos().x === pacmanPos.x && pinky.getPos().y === pacmanPos.y) || (inky.getPos().x === pacmanPos.x && inky.getPos().y === pacmanPos.y) || (clyde.getPos().x === pacmanPos.x && clyde.getPos().y === pacmanPos.y));
    }

    function movePacman(matrix, matrixCopy, pacmanPos, blinky, pinky, inky, clyde) {
        if (isGameOver(pacmanPos, blinky, pinky, inky, clyde) === true) {
            clearInterval(window.pacmanInterval);
            clearInterval(window.blinkyInterval);
            clearInterval(window.inkyInterval);
            clearInterval(window.pinkyInterval);
            clearInterval(window.clydeInterval);
            b.innerHTML = "<h1>Game Over</h1>";
        }
        if (pacmanPos.x + pacmanDirection.x >= 0 && pacmanPos.x + pacmanDirection.x < ROW_MAX && pacmanPos.y + pacmanDirection.y === -1) {
            matrix[pacmanPos.x][pacmanPos.y] = 'ze';
            matrixCopy[pacmanPos.x][pacmanPos.y] = 'ze';
            drawLevelParts(matrixCopy[pacmanPos.x][pacmanPos.y], pacmanPos);
            pacmanPos.y = COL_MAX-1;
            drawLevelParts(matrixCopy[pacmanPos.x][pacmanPos.y], pacmanPos);
        }
        else if (pacmanPos.x + pacmanDirection.x >= 0 && pacmanPos.x + pacmanDirection.x < ROW_MAX && pacmanPos.y + pacmanDirection.y === COL_MAX) {
            matrix[pacmanPos.x][pacmanPos.y] = 'ze';
            matrixCopy[pacmanPos.x][pacmanPos.y] = 'ze';
            drawLevelParts(matrixCopy[pacmanPos.x][pacmanPos.y], pacmanPos);
            pacmanPos.y = 0;
            drawLevelParts(matrixCopy[pacmanPos.x][pacmanPos.y], pacmanPos);
        }
        else if (pacmanPos.x + pacmanDirection.x >= 0 && pacmanPos.x + pacmanDirection.x < ROW_MAX && pacmanPos.y + pacmanDirection.y >= 0 && pacmanPos.y + pacmanDirection.y < COL_MAX && isValidClass(matrix[pacmanPos.x + pacmanDirection.x][pacmanPos.y + pacmanDirection.y])) {
            matrix[pacmanPos.x][pacmanPos.y] = 'ze';
            matrixCopy[pacmanPos.x][pacmanPos.y] = 'ze';
            drawLevelParts(matrixCopy[pacmanPos.x][pacmanPos.y], pacmanPos);
            pacmanPos.x += pacmanDirection.x;
            pacmanPos.y += pacmanDirection.y;
            drawLevelParts(matrixCopy[pacmanPos.x][pacmanPos.y], pacmanPos);
        }
    }

    function drawLevelParts(classAtPos, pos) {
        var posDiv = document.getElementById(pos.x + '_' + pos.y);
        if (posDiv === null) {
            var ijkl = document.getElementsByClassName('ijkl')[0];
            ijkl.innerHTML += "<div class=\"" + classAtPos + "\" id=\"" + pos.x + "_" + pos.y + "\"></div>";
            return;
        }
        posDiv.removeAttribute("class");
        posDiv.setAttribute("class", classAtPos);
    }

    function main() {
        var i, j;

        var pacmanPos = {x: 26, y: 15};//26, 15

        var matrix = levelGenerator(1);
        var matrixCopy = levelGenerator(1);
        matrixCopy[pacmanPos.x][pacmanPos.y] = 'pacmanUp360';

        for(i = 0; i < ROW_MAX; i++)
        {
            for(j = 0; j < COL_MAX; j++) {
                drawLevelParts(matrixCopy[i][j], {x: i, y: j});
            }
        }

        pacmanChangeDirection(matrix, pacmanPos, blinky, pinky, inky, clyde);
        window.pacmanInterval = setInterval(function() {
            movePacman(matrix, matrixCopy, pacmanPos, blinky, pinky, inky, clyde);
            if (window.pacmanMouthAngle >= 360)
                window.angleDiff = -45;
            else if (window.pacmanMouthAngle <= 270)
                window.angleDiff = 45;
            window.pacmanMouthAngle = window.pacmanMouthAngle + window.angleDiff;
            if (pacmanDirection.x === -1 && pacmanDirection.y === 0)
                matrixCopy[pacmanPos.x][pacmanPos.y] = "pacmanUp" + window.pacmanMouthAngle;
            else if (pacmanDirection.x === 1 && pacmanDirection.y === 0)
                matrixCopy[pacmanPos.x][pacmanPos.y] = "pacmanDown" + window.pacmanMouthAngle;
            else if (pacmanDirection.x === 0 && pacmanDirection.y === -1)
                matrixCopy[pacmanPos.x][pacmanPos.y] = "pacmanLeft" + window.pacmanMouthAngle;
            else if (pacmanDirection.x === 0 && pacmanDirection.y === 1)
                matrixCopy[pacmanPos.x][pacmanPos.y] = "pacmanRight" + window.pacmanMouthAngle;
            drawLevelParts(matrixCopy[pacmanPos.x][pacmanPos.y], pacmanPos);
            blinky.setClass(blinky.getClass().slice(0, -1) + (1.5 + alternateGhostAnimate).toString());
            pinky.setClass(pinky.getClass().slice(0, -1) + (1.5 + alternateGhostAnimate).toString());
            inky.setClass(inky.getClass().slice(0, -1) + (1.5 + alternateGhostAnimate).toString());
            clyde.setClass(clyde.getClass().slice(0, -1) + (1.5 + alternateGhostAnimate).toString());
            matrixCopy[blinky.getPos().x][blinky.getPos().y] = blinky.getClass();
            matrixCopy[pinky.getPos().x][pinky.getPos().y] = pinky.getClass();
            matrixCopy[inky.getPos().x][inky.getPos().y] = inky.getClass();
            matrixCopy[clyde.getPos().x][clyde.getPos().y] = clyde.getClass();
            drawLevelParts(matrixCopy[blinky.getPos().x][blinky.getPos().y], blinky.getPos());
            drawLevelParts(matrixCopy[pinky.getPos().x][pinky.getPos().y], pinky.getPos());
            drawLevelParts(matrixCopy[inky.getPos().x][inky.getPos().y], inky.getPos());
            drawLevelParts(matrixCopy[clyde.getPos().x][clyde.getPos().y], clyde.getPos());
            alternateGhostAnimate =  alternateGhostAnimate * -1;
        }, pacmanSpeed);


        window.blinkyInterval = setInterval(function() {
            if (blinkyLeftHouse === true)
                blinky.move(matrix, matrixCopy, pacmanPos, pacmanPos, inky, pinky, clyde);
            else if (blinkyLeftHouse === false)
                blinky.move(matrix, matrixCopy, pacmanPos, {x: 11, y: 14}, inky, pinky, clyde);
            var blinkyPos = blinky.getPos();
            if (blinkyPos.x === 11 && blinkyPos.y === 14)
                window.blinkyLeftHouse = true;
            else if (blinkyPos.x >= 12 && blinkyPos.x <= 16 && blinkyPos.y >= 10 && blinkyPos.y <= 17)
                window.blinkyLeftHouse = false;
        }, blinky.getSpeed());

        window.inkyInterval = setInterval(function() {
            if (inkyLeftHouse === true)
                inky.move(matrix, matrixCopy, pacmanPos, {x: pacmanPos.x + 4*pacmanDirection.x, y: pacmanPos.y + 4*pacmanDirection.y}, blinky, pinky, clyde);
            else if (inkyLeftHouse === false)
                inky.move(matrix, matrixCopy, pacmanPos, {x: 11, y: 14}, blinky, pinky, clyde);
            var inkyPos = inky.getPos();
            if (inkyPos.x === 11 && inkyPos.y === 14)
                window.inkyLeftHouse = true;
            else if (inkyPos.x >= 12 && inkyPos.x <= 16 && inkyPos.y >= 10 && inkyPos.y <= 17)
                window.inkyLeftHouse = false;
        }, inky.getSpeed());

        window.pinkyInterval = setInterval(function() {
            if (pinkyLeftHouse === true)
                pinky.move(matrix, matrixCopy, pacmanPos, {x: pacmanPos.x - 4*pacmanDirection.x, y: pacmanPos.y - 4*pacmanDirection.y}, inky, blinky, clyde);
            else if (pinkyLeftHouse === false)
                pinky.move(matrix, matrixCopy, pacmanPos, {x: 11, y: 14}, inky, blinky, clyde);
            var pinkyPos = pinky.getPos();
            if (pinkyPos.x === 11 && pinkyPos.y === 14)
                window.pinkyLeftHouse = true;
            else if (pinkyPos.x >= 12 && pinkyPos.x <= 16 && pinkyPos.y >= 10 && pinkyPos.y <= 17)
                window.pinkyLeftHouse = false;
        }, pinky.getSpeed());

        window.clydeInterval = setInterval(function() {
            if (clydeLeftHouse === true)
                clyde.move(matrix, matrixCopy, pacmanPos, {x: pacmanPos.x - 4*pacmanDirection.x, y: pacmanPos.y - 4*pacmanDirection.y}, inky, blinky, pinky);
            else if (clydeLeftHouse === false)
                clyde.move(matrix, matrixCopy, pacmanPos, {x: 11, y: 14}, inky, blinky, pinky);
            var clydePos = clyde.getPos();
            if (clydePos.x === 11 && clydePos.y === 14)
                window.clydeLeftHouse = true;
            else if (clydePos.x >= 12 && clydePos.x <= 16 && clydePos.y >= 10 && clydePos.y <= 17)
                window.clydeLeftHouse = false;
        }, pinky.getSpeed());
    }

    function pacmanChangeDirection(matrix, pacmanPos, blinky, pinky, inky, clyde) {
        var map = {};
        onkeydown = onkeyup = function(event) {
            event = event || event;
            map[event.keyCode] = event.type === 'keydown';
            if (map[37] === true || map[38] === true || map[39] === true || map[40] === true) {
                if (isGameOver(pacmanPos, blinky, pinky, inky, clyde) === true) {
                    clearInterval(window.pacmanInterval);
                    clearInterval(window.blinkyInterval);
                    clearInterval(window.inkyInterval);
                    clearInterval(window.pinkyInterval);
                    clearInterval(window.clydeInterval);
                    b.innerHTML = "<h1>Game Over</h1>";
                }
                if (map[38] === true) {
                    if (isValid(pacmanPos.x - 1, pacmanPos.y) && isValidClass(matrix[pacmanPos.x - 1][pacmanPos.y]))
                        pacmanDirection = {x: -1, y: 0};
                }
                if (map[37] === true) {
                    if (isValid(pacmanPos.x, pacmanPos.y - 1) && isValidClass(matrix[pacmanPos.x][pacmanPos.y - 1]))
                        pacmanDirection = {x: 0, y: -1};
                }
                if (map[40] === true) {
                    if (isValid(pacmanPos.x + 1, pacmanPos.y) && isValidClass(matrix[pacmanPos.x + 1][pacmanPos.y])) {
                        pacmanDirection = {x: 1, y: 0};
                    }
                }
                if (map[39] === true) {
                    if (isValid(pacmanPos.x, pacmanPos.y + 1) && isValidClass(matrix[pacmanPos.x][pacmanPos.y + 1]))
                        pacmanDirection = {x: 0, y: 1};
                }
            }
        };
    }
    main();
</script>
</html>